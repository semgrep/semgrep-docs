---
slug: java-xxe
---

# XML External Entity prevention for Java

This is an XML External Entity (XXE) prevention cheat sheet by r2c. It contains code patterns of potential XXE in an application. Instead of scrutinizing code for exploitable vulnerabilities, the recommendations in this cheat sheet pave a safe road for developers that mitigates the possibility of XXE in your code. By 
following these recommendations, you can be reasonably sure your code is free of XXE.

## Mitigation Summary

XML security in Java is not easy to summarize. On the one hand, the XML standard allows multiple ways to include external content, including but not limited to external Document Type Definitions (DTD), external Entity References to external data, general entity references, and external parameter references.
There are also several ways to include external content in XML Schemas and stylesheets.

On the other hand, the Java API for XML Processing (JAXP) contains mutliple interfaces to process XML content. The Document Object Model (DOM) interface, the Simple API for XML (SAX) interface, and the Streaming API for XML (StAX) interface.
Each of these interfaces have their own mitigation measures to disable allowing use of different sources of external content.
The inconsitency in availability and even effect of these measures across the different APIs, combined with the variety of ways to include external content, makes it difficult to make a general recommendation. Many configurations that are secure for one parser are not for another.
However, the following settings have a consistent effect on a subset of parsers

- For `DocumentBuilderFactory`. `SAXBuilder`, `SAXParser`, `SAXReader`, and `XMLReader` use:
    ```
    setFeature(http://apache.org/xml/features/disallow-doctype-decl, true);
    ```
- For `SAXTransformer`, `SchemaFactory`, and `Validator` use:
    ```
    setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
    ```

The complete Semgrep ruleset for this cheatsheet is available as part of the premium rules for Team Tier customers. It includes rules to verify these settings as well as a number of other combinations that are secure.

---

## 1 Exponential entity expansion

Expontential entity expansion happens when there are several layers of nested entities that each on their own refer to a number of other entities.
You can find an [example of such a payload](https://github.com/returntocorp/java-xxe-research/blob/main/payloads-new/xml-attacks/xml-bomb.xml) (sometimes called an XML Bomb) in our research project on GitHub.

When a document like this is parsed, the parser will expand each of the nested references. The expansion becomes exponentially large and this can lead to excessive use of the resources and denial-of-service (DoS).
We found that in Java, the JDK throws an exception when such excessive use of resources is detected. When it is carefully caught and handled, this will prevent the attack. So no explicit security measures need to be taken.
This is the case for all recent versions of Java (17, 18, 19) and all older versions with long term support (8, 11).

## 2 XML External Entity Injection

XML External Entity Injection happens when the system identifier to some of the external content contains data controlled by an attacker. The parser will then dereference this identifier containing attacker-controlled XML code, leading to disclosure of confidential data, or even arbitrary code execution.

### 2.A Ways to include external content in XML documents

- External DTD: references an external Document Type Definition (DTD)
    ```xml
    <!DOCTYPE root_element SYSTEM "url">
    ```
- External Entity Reference: Refers to external data, the following is the syntax:
    ```xml
    <!ENTITY name SYSTEM "url">
    ```
- General entity reference, for example:
    ```xml
    <?xml version="1.0" standalone="no" ?>
    <!DOCTYPE doc [<!ENTITY otherFile SYSTEM "otherFile.xml">]>
    <doc>
        <a>
            <b>&otherFile;</b>
        </a>
    </doc>
    ```
- External Parameter Entities, for example:
    ```xml
    <?xml version="1.0" standalone="no"?>
        <!DOCTYPE doc [
          <!ENTITY % ent1 SYSTEM "http://www.example.com/student.dtd">
          %ent1;
        ]>
    ```
- XInclude: Includes an external infoset in an XML document, for example:
    ```xml
    <Book xmlns:xi="http://www.w3.org/2001/XInclude">
        <xi:include href=toc.xml"/>
        <xi:include href=part1.xml"/>
        <xi:include href=part2.xml"/>
        <xi:include href=index.xml"/>
    </Book>
    ```
- References to XML Schema components using the schemaLocation attribute and import and include elements, for example:
    ```xml
    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
        <xs:include schemaLocation="http://www.example.com/schema/schema1.xsd"/>
        <!-- ... -->
    </xs:schema>
    ```
- Combining style sheets using import or include elements, the following is the syntax:
    ```xml
    <xsl:include href="include.xsl"/>
    ```
- `xml-stylesheet` processing instruction: Used to include a stylesheet in an XML document, for example:
    ```xml
    <?xml-stylesheet href="include.xsl" type="text/xsl"?>
    ```
- XSLT document() function: Used to access nodes in an external XML document, for example:
    ```xml
    <xsl:variable name="dummy" select="document('DocumentFunc2.xml')"/>
    ```

#### References

- [Oracle Docs](https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html)

### 2.B Security measures

There are a number of security measures, not all of them are available for each class. To see an overview of which measures are available for which class, consult the docs, or go to Section 3 to view the tables with our research results.

#### Feature for Secure Processing (FSP)

Feature for Secure Processing (FSP) is considered the central mechanism for secure XML processing. It is defined as `javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING`.
For a number of classes this feature is able to protect the parser from all available payloads, but this is not the case for all of the classes we tested.

#### Disabling DTD processing

To disable DTD processing there are a few mechanisms available:

- The `setFeature` method with the following url: `http://apache.org/xml/features/disallow-doctype-decl`. 
- The `setProperty` method to set `XMLInputFactory.SUPPORT_DTD` to false.
- The `setAttribute` method to set `XMLConstants.ACCESS_EXTERNAL_DTD` to an empty string (`“”`). 

For some parsers, multiple of these methods are available. 

For most parsers this setting adds additional security for processing XML documents, but it never has any effect on processing schemas or stylesheets. 
However, there are classes such as `DocumentBuilderFactory`, `Validator`, and `SchemaFactory` where multiple of these methods are available, and setting the above mentioned features throws no exceptions, but only one of them has any effect on the security of the parser.

#### Disabling external schema and stylesheet processing

The `setAttribute` method can be used to set `XMLConstants.ACCESS_EXTERNAL_SCHEMA` and `XMLConstants.ACCESS_EXTERNAL_STYLESHEET` to an empty string to disable these features.
The effects on security, however, are often limited, with no observed effect for a number of classes.

#### Disabling external general entities and external parameter entities

The  `setFeature` method can be used to set `http://xml.org/sax/features/external-general-entities` and `http://xml.org/sax/features/external-parameter-entities` to false. For the classes where these features are available, the combination of these two protects the parser against all of the tested payloads!
Except for the `Validator` class, where they have no effect at all.
There is also `setExpandEntityReferences` that can be set to false and seems to have the same effect as disabling external general entities, based on our testing.

## 3 Overview of effect of security measures for each class

✅ Secure
❌ Not Secure
⚠️  An exception is thrown

### 3.A DocumentBuilderFactory

| DocumentBuilderFactory                                                              | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | ✅⚠️       | ✅   | ❌                | ✅   | ✅      | ✅       | ✅        | ✅   | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | ✅⚠️       | ❌   | ✅                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setValidating(false)                                                                | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setExpandEntityReferences(false)                                                    | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setXIncludeAware(false)                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setNamespaceAware(true)                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |

### 3.B SAXBuilder

| SAXBuilder                                                                          | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| Default config DTDValidating                                                        | ✅⚠️       | ✅⚠️  | ❌                | ✅⚠️  | ✅⚠️     | ✅⚠️      | ✅⚠️       | ✅⚠️  | ✅⚠️     | ✅⚠️      |
| Default config XSDValidating                                                        | ✅⚠️       | ✅⚠️  | ❌                | ✅⚠️  | ✅⚠️     | ✅⚠️      | ✅⚠️       | ✅⚠️  | ✅⚠️     | ✅⚠️      |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | ✅⚠️       | ✅   | ❌                | ✅   | ✅      | ✅       | ✅        | ✅   | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | ✅⚠️       | ❌   | ✅                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setExpandEntities(false)                                                            | ✅⚠️       | ✅   | ❌                | ✅   | ✅      | ✅       | ✅        | ✅   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |

### 3.C SAXParserFactory

| SAXParserFactory                                                                    | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | ✅⚠️       | ✅   | ❌                | ✅   | ✅      | ✅       | ✅        | ✅   | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | ✅⚠️       | ❌   | ✅                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setValidating(false)                                                                | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setExpandEntityReferences(false)                                                    | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setXIncludeAware(false)                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setNamespaceAware(true)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |

### 3.D SAXParser

| SAXParser                                                                           | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             |          |     |                  |     |        |         |          |     |        |         |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                   | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                                | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setProperty(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                           | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setValidating(false)                                                                | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setExpandEntityReferences(false)                                                    | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setXIncludeAware(false)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setNamespaceAware(true)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |

### 3.E SAXReader

| SAXReader                                                                           | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | ✅⚠️       | ✅   | ❌                | ✅   | ✅      | ✅       | ✅        | ✅   | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | ✅⚠️       | ❌   | ✅                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setValidating(false)                                                                | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setExpandEntityReferences(false)                                                    | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setXIncludeAware(false)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setNamespaceAware(true)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setIncludeExternalDTDDeclarations(false);                                           | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |

### 3.F TransformerFactory & SAXTransformerFactory

| TransformerFactory/SAXTransformerFactory                                            | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ❌      | ❌       | ❌        | n/a | n/a    | n/a     |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅⚠️     | ✅⚠️      | ✅⚠️       | n/a | n/a    | n/a     |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ❌      | ❌       | ❌        | n/a | n/a    | n/a     |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | ✅⚠️       | ❌   | ❌                | ❌   | ✅⚠️     | ✅⚠️      | ✅⚠️       | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setValidating(false)                                                                | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setExpandEntityReferences(false)                                                    | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setXIncludeAware(false)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setNamespaceAware(true)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |

### 3.G SchemaFactory 

| SchemaFactory                                                                       | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | n/a | n/a    | n/a     | n/a      | ❌   | ❌      | ❌       |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ✅⚠️  | ✅⚠️               | n/a | n/a    | n/a     | n/a      | ✅⚠️  | ✅⚠️     | ✅⚠️      |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ✅⚠️  | ✅⚠️               | n/a | n/a    | n/a     | n/a      | ✅⚠️  | ❌      | ❌       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | ✅⚠️       | ❌   | ❌                | n/a | n/a    | n/a     | n/a      | ❌   | ✅⚠️     | ✅⚠️      |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ❌   | ❌                | n/a | n/a    | n/a     | n/a      | ✅⚠️  | ❌      | ❌       |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setValidating(false)                                                                | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setExpandEntityReferences(false)                                                    | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setXIncludeAware(false)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setNamespaceAware(true)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |

### 3.H Validator 

| Validator                                                                           | DoS      | XML | XML              |
|-------------------------------------------------------------------------------------|----------|-----|------------------|
|                                                                                     | xml-bomb | dtd | parameter entity |
| default                                                                             | ✅⚠️       | ❌   | ❌                |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ✅⚠️  | ✅⚠️               |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ✅⚠️  | ✅⚠️               |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | ✅⚠️       | ❌   | ❌                |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ❌   | ❌                |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | ✅⚠️       | ❌   | ❌                |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | ✅⚠️       | ❌   | ❌                |
| setValidating(false)                                                                | ✅⚠️       | n/a | n/a              |
| setExpandEntityReferences(false)                                                    | ✅⚠️       | n/a | n/a              |
| setXIncludeAware(false)                                                             | ✅⚠️       | n/a | n/a              |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | ✅⚠️       | n/a | n/a              |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | ✅⚠️       | n/a | n/a              |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | ✅⚠️       | n/a | n/a              |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | ✅⚠️       | n/a | n/a              |
| setNamespaceAware(true)                                                             | ✅⚠️       | n/a | n/a              |

### 3.I XMLReader 

| XMLReader                                                                           | DoS      | XML | XML              | XSL | XSL    | XSL     | XSL      | XSD | XSD    | XSD     |
|-------------------------------------------------------------------------------------|----------|-----|------------------|-----|--------|---------|----------|-----|--------|---------|
|                                                                                     | xml-bomb | dtd | parameter entity | dtd | import | include | document | dtd | import | include |
| default                                                                             | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)                            | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "")                                  | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "")                               | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");                          | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/disallow-doctype-decl", true)            | ✅⚠️       | ✅⚠️  | ✅⚠️               | ✅⚠️  | ✅      | ✅       | ✅        | ✅⚠️  | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-general-entities", false)          | ✅⚠️       | ✅   | ❌                | ✅   | ✅      | ✅       | ✅        | ✅   | ✅      | ✅       |
| setFeature("http://xml.org/sax/features/external-parameter-entities", false)        | ✅⚠️       | ❌   | ✅                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setValidating(false)                                                                | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setExpandEntityReferences(false)                                                    | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setXIncludeAware(false)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/xinclude", false)                        | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) | ✅⚠️       | ❌   | ❌                | ❌   | ✅      | ✅       | ✅        | ❌   | ✅      | ✅       |
| setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)  | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setFeature("http://apache.org/xml/features/namespaces", false)                      | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |
| setNamespaceAware(true)                                                             | n/a      | n/a | n/a              | n/a | n/a    | n/a     | n/a      | n/a | n/a    | n/a     |

