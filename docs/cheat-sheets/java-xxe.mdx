---
slug: java-xxe
toc_max_heading_level: 4
---

# XML External Entity prevention for Java

This is an XML External Entity (XXE) prevention cheat sheet by r2c. It contains code patterns of potential XXE in an application. The recommendations in this cheat sheet pave a safe road for developers that mitigate the possibility of XXE in their code. By following these recommendations, you can be reasonably sure that their code is free of XXE.

## Mitigation Summary

It is not easy to summarize Java XML security. The XML standard allows multiple ways to include external content, including but not limited to external Document Type Definitions (DTD), external Entity References to external data, general entity references, and external parameter references. There are also several ways to include external content in XML Schemas and stylesheets.

The Java API for XML Processing (JAXP) contains multiple interfaces to process XML content:

- The Document Object Model (DOM) interface
- The Simple API for XML (SAX) interface
- The Streaming API for XML (StAX) interface

Each of these interfaces has its mitigation measures to disable the use of different sources of external content. The&nbsp;inconsistency in availability and even the effect of these measures across the different APIs, combined with the variety of ways to include external content makes it difficult to provide general mitigation recommendations. Many configurations that are secure for one parser are not secure for another.
However, the following settings have a consistent effect on a subset of parsers

- For `SAXBuilder`, `SAXParser`, and `XMLReader` use:
    ```java
    setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "");
    ```
- For `DocumentBuilderFactory`, `TransformerFactory`, `SAXTransformer`, `SchemaFactory`, and `Validator` use:
    ```java
    setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
    ```
- For `SAXReader` the only secure configuration is:
    ```java
    setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl", true);

    ```

The complete [Semgrep ruleset](https://semgrep.dev/r?q=java.lang.security.xxe&lang=Java) that covers vulnerabilities mentioned in this cheat sheet is available as part of the rules available in the Team tier. This ruleset includes rules to verify these settings as well as several other combinations that are secure.

The following infographics provides Java XXE security features overview:

![XXE Java security features overview infographics](/img/cheat-sheets-xxe-java-infographics.png "XXE Java security features overview infographics")

---

## 1. Exponential entity expansion

Exponential entity expansion occurs when there are several layers of nested entities that reference several other entities.
See an example of such a payload, called also an XML bomb, in [r2c's research project on GitHub](https://github.com/returntocorp/java-xxe-research/blob/main/payloads-new/xml-attacks/xml-bomb.xml).

When a document containing an XML bomb is parsed, the parser expands each of the nested references. Consequently, this expansion becomes exponential leading to excessive use of resources and Denial-of-Service (DoS).
We found that in Java, the JDK throws an exception when such excessive use of resources is detected. 
Using this exception, if it is carefully caught and handled, the attack can be prevented. In such a case, no explicit security measures need to be taken. This is the case for all recent versions of Java (17, 18, 19) and all older versions with long-term support (8, 11).

## 2. XML External Entity Injection

XML External Entity Injection occurs when the system identifier to some of the external content contains data controlled by an attacker. The parser then dereferences this identifier containing attacker-controlled XML code, leading to the disclosure of confidential data, or even to arbitrary code execution.

### 2.A Ways to include external content in XML documents

There are many potential ways in which external resources can be referenced in XML documents, XML Schemas, and XSLT stylesheets. External content can be loaded through an External Document Type Definition (DTD), an External Entity Reference to external data, a General Entity reference, or an External Parameter Entity reference. Additional XML code can also be included through `XInclude`, or references to XML Schema components using the `schemaLocation` attribute of `import` or `include` elements. In stylesheets, multiple sheets can be combined using the `xsl:include` element, the `?xml-stylesheet` processing instruction, or the `document()` function.

For examples of each of these ways of including external resources, see the [Java API for XML Processing (JAXP) Security Guide](https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html) in Oracle documentation. In addition, you can review r2c's [research project on GitHub](https://github.com/returntocorp/java-xxe-research/tree/main/payloads-new).

### 2.B Security measures

There are several security measures, but not all of them are available for each class. See an overview of which measures are available for which class in section [3. Overview of the effect of security measures for each class](#3-overview-of-the-effect-of-security-measures-for-each-class) with r2c research results.

#### Feature for Secure Processing (FSP)

Feature for Secure Processing (FSP) is considered the central mechanism for secure XML processing. It is defined as `javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING`.
For various classes, this feature can protect the parser from all available payloads. However, this is not the case for all of the classes we tested.

#### Disabling DTD processing

To disable DTD processing with one of the available mechanisms:

- The `setFeature` method with the following URL: `http://apache.org/xml/features/disallow-doctype-decl`
- The `setProperty` method to set `XMLInputFactory.SUPPORT_DTD` to false.
- The `setAttribute` method to set `XMLConstants.ACCESS_EXTERNAL_DTD` to an empty string (`“”`). 

For some parsers, there are multiple methods to disable DTD processing. For most parsers, this setting adds additional security for processing XML documents. However, this does not affect the processing of schemas or stylesheets. Still, there are classes such as `DocumentBuilderFactory`, `Validator`, and `SchemaFactory` with multiple methods to disable DTD, and setting the above-mentioned features throws no exceptions, but only one of them has any effect on the security of the parser.

#### Disabling external schema and stylesheet processing

The `setAttribute` method can be used to set `XMLConstants.ACCESS_EXTERNAL_SCHEMA` and `XMLConstants.ACCESS_EXTERNAL_STYLESHEET` to an empty string to disable these features.
The effects on security, however, are often limited, with no observed effect for several classes.

#### Disabling external entities

Set `setFeature` to `false` to disable `http://xml.org/sax/features/external-general-entities` and `http://xml.org/sax/features/external-parameter-entities` features. When both of these features are disabled, all parsers are protected against all of the tested payloads.
Except for the `Validator` class, where they have no effect at all.
There is also `setExpandEntityReferences` that can be set to false and seems to have the same effect as disabling external general entities, based on our testing.

## 3. Overview of the effect of security measures for each class

Summarizing security measures against XXE is not easy as not all security measures work for every class (as mentioned in section [2.B Security measures](#2b-security-measures)). The tables below this section can help you to choose the best security measures against a specific vulnerability.

:::info Table legend
- Each table represents one Java class. For example `DocumentBuilderFactory`.
- Columns display attack payloads that can be potentially used to exploit a vulnerability (for example DTD or XML bomb).
- Rows represent ways to configure the parsers.

✅ - Secure<br />
❌ - Not Secure<br />
⚠️  - An exception is thrown<br />
N/A - Not available
:::

### 3.A DocumentBuilderFactory

[`javax.xml.parsers.DocumentBuilderFactory`](https://docs.oracle.com/javase/7/docs/api/javax/xml/parsers/DocumentBuilderFactory.html) can be used to process all payload types. By default it is vulnerable against 4 of the attack payloads.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="10">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-general-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-parameter-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setValidating</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setExpandEntityReferences</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setXIncludeAware</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>xinclude</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-external-dtd</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-dtd-grammar</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>namespaces</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setNamespaceAware</b>(true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
    </tbody>
</table>
</font>


### 3.B SAXBuilder

[`org.jdom2.input.SAXBuilder`](http://www.jdom.org/docs/apidocs/org/jdom2/input/SAXBuilder.html) can process all 10 payloads. In the default configuration it is vulnerable for 4 of the attack payloads.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="10">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                Default configuration DTDValidating
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                Default configuration XSDValidating
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅  </td>
            <td> ✅  </td>
            <td> ✅  </td>
            <td> ✅⚠️  </td>
            <td> ✅  </td>
            <td> ✅  </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅  </td>
            <td> ✅  </td>
            <td> ✅  </td>
            <td> ✅⚠️  </td>
            <td> ✅  </td>
            <td> ✅  </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-general-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-parameter-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setExpandEntityReferences</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>xinclude</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-external-dtd</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
    </tbody>
</table>
</font>

### 3.C SAXParserFactory

[`javax.xml.parsers.SAXParserFactory`](https://docs.oracle.com/javase/7/docs/api/javax/xml/parsers/SAXParserFactory.html) can process all 10 attack payloads. Its default configuration is vulnerable to 4 of the attack payloads.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="10">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-general-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-parameter-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setValidating</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setExpandEntityReferences</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setXIncludeAware</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>xinclude</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-external-dtd</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-dtd-grammar</b>", false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>namespaces</b>", false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setNamespaceAware</b>(true)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
    </tbody>
</table>
</font>

### 3.D SAXParser

[`javax.xml.parsers.SAXParser`](https://docs.oracle.com/javase/7/docs/api/javax/xml/parsers/SAXParser.html) can process all 10 payloads. Its default configuration is vulnerable to 4 attack payloads.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="10">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td> All other features
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
    </tbody>
</table>
</font>

### 3.E SAXReader

[`org.dom4j.io.SAXReader`](https://dom4j.github.io/javadoc/2.0.1/org/dom4j/io/SAXReader.html) can process all 10 payloads. Its default configuration is vulnerable to 4 of the attack payloads.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="10">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-general-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-parameter-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setValidating</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setExpandEntityReferences</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setXIncludeAware</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>xinclude</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-external-dtd</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-dtd-grammar</b>", false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>namespaces</b>", false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setNamespaceAware</b>(true)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setIncludeExternalDTDDeclarations</b>(false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
    </tbody>
</table>
</font>


### 3.F TransformerFactory & SAXTransformerFactory

[`javax.xml.transform.TransformerFactory`](https://docs.oracle.com/javase/7/docs/api/javax/xml/transform/TransformerFactory.html) and [`javax.xml.transform.sax.SAXTransformerFactory`](https://docs.oracle.com/javase/7/docs/api/javax/xml/transform/sax/SAXTransformerFactory.html) 
are not able to process XML Schema Definition (XSD) payloads. Out of the 7 payloads they can process, the default configurations parses 6 payloads insecurely.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="7">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td> All other features
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
    </tbody>
</table>
</font>

### 3.G SchemaFactory 

[`javax.xml.validation.SchemaFactory`](https://docs.oracle.com/javase/7/docs/api/javax/xml/validation/SchemaFactory.html) is unable to process XML Stylesheet Language (XSL) documents.
Out of the 6 payloads it can process, the default configuration is vulnerable to 5 of them.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="6">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td> All other features
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
    </tbody>
</table>
</font>

### 3.H Validator 

[`javax.xml.validation.Validator`](https://docs.oracle.com/javase/7/docs/api/javax/xml/validation/Validator.html) can only process XML documents, not XSL or XSD. 
Out of the 3 attack payloads it can process, the default configuration is vulnerable to 2 of them.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="3">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-general-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-parameter-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
        </tr>
        <tr>
            <td>
            All other features
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
    </tbody>
</table>
</font>

### 3.I XMLReader

[`org.xml.sax.XMLReader`](https://docs.oracle.com/javase/7/docs/api/org/xml/sax/XMLReader.html) can process all 10 payloads.
The default configuration is vulnerable to 4 of the attack payloads.

<font size="2">
<table>
    <thead>
        <tr>
            <th rowspan="3">Security feature</th>
            <th colspan="10">Attack payload</th>
        </tr>
        <tr>
            <th colspan="3">XML</th>
            <th colspan="4">XSL</th>
            <th colspan="3">XSD</th>
        </tr>
        <tr>
            <th style={{"writing-mode" : "vertical-lr" }} >XML Bomb</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >Parameter entity</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
            <th style={{"writing-mode" : "vertical-lr" }} >document</th>
            <th style={{"writing-mode" : "vertical-lr" }} >DTD</th>
            <th style={{"writing-mode" : "vertical-lr" }} >import</th>
            <th style={{"writing-mode" : "vertical-lr" }} >include</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                Default configuration
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, "")</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, "")</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>disallow-doctype-decl</b>", true)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-general-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://xml.org/sax/features/<b>external-parameter-entities</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code><b>setValidating</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setExpandEntityReferences</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setXIncludeAware</b>(false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>xinclude</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-external-dtd</b>", false)</code>
            </td>
            <td> ✅⚠️  </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ✅ </td>
            <td> ❌ </td>
            <td> ✅ </td>
            <td> ✅ </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/nonvalidating/<b>load-dtd-grammar</b>", false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code>setFeature("http://apache.org/xml/features/<b>namespaces</b>", false)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
        <tr>
            <td>
                <code><b>setNamespaceAware</b>(true)</code>
            </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
            <td> N/A </td>
        </tr>
    </tbody>
</table>
</font>

