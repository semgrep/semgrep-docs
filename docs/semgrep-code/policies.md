---
slug: policies
append_help_link: true
title: Set rules through Policies
hide_title: true
description: "The Policies page is a visual representation of the rules that Semgrep Code uses to scan code."
tags:
    - Semgrep Code
    - Semgrep AppSec Platform
---

# Set rules through Policies

Increase the breadth and depth of your scan coverage or remove noise from scans through the Policies page. Block or allow merges for pull requests (PRs) or merge requests (MRs) based on the rule that detected the finding.

The Policies page displays a visual representation of the rules that Semgrep Code uses for scanning. By default, the same rules in Policies are applied to all repositories.

To learn more about rules, see [<i class="fa-regular fa-file-lines"></i> Running rules](/running-rules).

:::info Speed and language coverage
Semgrep Code identifies the languages used in your repositories and **only runs rules applicable to those languages**.

For example, adding Ruby and Python rules in your Policies **does not affect the scan speed** for Python-only repositories. Only Python rules are run for Python repositories.
:::

## Policies page structure

![Default view of the Policies page](/img/policies.png)
_**Figure.**_ Default view of the Policies page, known as the **Group by vulnerability class** view.

The Policies page consists of a header and three main panes:

<dl>
    <dt>Policies header</dt>
    <dd>
        <span>The top header consists of:</span>
        <ul>
            <li>
              <span><strong>Policies view drop-down</strong>, which lets you choose between:</span>
                <ul>
                    <li>Grouping rules by vulnerability class</li>
                    <li>No grouping</li>
                </ul>
            </li>
            <li><i class="fa-solid fa-gear"></i> <b>Rule Modes</b> button where you can view <strong>rule modes</strong> and edit <strong>notifications</strong> for each rule mode. Rule modes define what <strong>workflow actions</strong> Semgrep Code performs when a rule detects a finding. For example, setting a rule's mode to <strong>Comment</strong> means that Semgrep posts PR or MR comments from findings generated by that rule. See <a href="#blocking-a-pr-or-mr-through-rule-modes">Blocking a PR or MR through rule modes</a> for more information.</li>
            <li><strong>Add rules</strong> button that takes you to the <a href="https://semgrep.dev/explore"><i class="fas fa-external-link fa-xs"></i> Semgrep Registry</a> where you can add rules to the Policies page and assign their initial modes.</li>
        </ul>
    </dd>
    <dt>Filter pane</dt>
    <dd>Displays filters to quickly select and perform operations on rules in bulk. See <a href="#policies-filter-reference">Policies filter reference</a> for more information.</dd>
    <dt>Rule pane</dt>
    <dd>The rule pane displays the rules that Semgrep scans use to detect findings and allows you to edit their assigned rule modes. You can make these edits either one by one or through bulk editing of many rules. You can also use the <strong>Search for rule names or ids</strong> box. See <a href="#policies-filter-reference">Policies filter reference</a> for more information.</dd>
</dl>

## Block a PR or MR through rule modes

Semgrep enables you to set a **workflow action** based on the presence of a finding. Workflow actions include:

* Failing a CI job. Semgrep returns exit code `1`, and you can use this result to set up additional checks to enforce a block on a PR or MR.
* Leaving a PR or MR comment.
* Notifying select channels, such as private Slack channels or webhooks.

Semgrep Code provides three rule modes:

| Rule mode | Description |
| -------   | ------ |
| Monitor   | Rules in **Monitor mode** display findings only in: <ul><li>Semgrep AppSec Platform</li><li>User-defined notifications</li></ul>Set rules to this mode to evaluate their true positive rate and other criteria you may have. By keeping rules in Monitor, developers do not receive potentially noisy findings in their PRs or MRs.  |
| Comment   | Rules in **Comment mode** display findings in:<ul><li>Developers' PRs or MRs</li><li>Semgrep AppSec Platform</li><li>User-defined notifications</li></ul>Set rules that have met your performance criteria to this mode when you are ready to display findings to developers.     |
| Block     | Rules in **Block mode** cause the scan job to fail with an exit code of `1` if Semgrep Code detects a finding from these rules. You can use this result to enforce a block on the PR or MR. For example, GitHub users can enable branch protection and set the PR to fail if the Semgrep step fails. <br />These rules display findings in:<ul><li>Developers' PRs or MRs</li><li>Semgrep AppSec Platform</li><li>User-defined notifications</li></ul>These are typically high-confidence, high-severity rules. |

Semgrep Code provides first-time users with the [<i class="fas fa-external-link fa-xs"></i> Default ruleset](https://semgrep.dev/p/default). These rules are initially placed in the Monitor column. As you develop confidence in these rules, you are able to change their modes to Comment or Block, ensuring that developers remain free of friction from false positives.

## Add rules

To add rules, follow these steps:

1. On the [<i class="fas fa-external-link fa-xs"></i> Policies](https://semgrep.dev/orgs/-/policies) page, click **Add Rules**.
1. You are redirected to the [<i class="fas fa-external-link fa-xs"></i> Semgrep Registry](https://semgrep.dev/explore) page. Explore the page, open cards of individual rules, and then click **Add to Policy**.
1. Specify the workflow action of the rule that you are adding. Select either:
    - Monitor
    - Comment
    - Block

### Add custom rules to your Policies

To add custom rules, use the Semgrep Editor. See [<i class="fa-regular fa-file-lines"></i> Setting code standards with the Policies page](/semgrep-code/editor#add-a-rule-to-the-policies-page).

### Add rulesets to your Policies

Rather than adding individual rules to your Policies, you can add rulesets, which are groups of rules related through a programming language, OWASP category, or framework the Semgrep team has curated.

1. On the [<i class="fas fa-external-link fa-xs"></i> Policies](https://semgrep.dev/orgs/-/policies) page, click **Add Rules**.
2. You are redirected to the [<i class="fas fa-external-link fa-xs"></i> Semgrep Registry](https://semgrep.dev/explore) page. Explore the page to find the ruleset you're interested in adding.
3. Click the ruleset to open its **Explore** page. This page lets you view the included rules and provides instructions for testing and running the ruleset locally before adding it to your policies.
4. Click **Add to Policy**.
5. Specify the workflow action for the rules that you are adding by selecting one of these options:
    - Monitor
    - Comment
    - Block

If Semgrep adds rules to the ruleset in the future, they will automatically be added to your Policies in the same mode that you select. You can change the default mode for the current and future rules by re-adding the ruleset through the Registry and choosing a different mode. You *cannot* change the mode of all existing rules associated with the ruleset using the Policies page, since this only makes every rule that you changed an exception to the default.

## Disable rules

To disable a rule, follow these steps:

1. On the **Policies** page, select either:
    - The top **<span className="placeholder">Number</span> Matching Rules** checkbox to select all rules.
    - Select individual checkboxes next to a rule to disable rules one by one.
1. Click **(<span className="placeholder">Number</span>) Edit**, and then click **Disabled**.

You can also select individual rules under the **Mode** column and disable them one by one.

## Policies filter reference

This section defines the Policies page filters:

| Filter | Description | Examples or possible values |
| -------  | ------ | ------ |
| Modes  | Filter by the workflow action Semgrep performs when a rule detects a finding. An additional filter, **Disabled**, is provided for rules that you have turned off and are no longer included for scanning.  | See [Rule modes](#blocking-a-pr-or-mr-through-rule-modes) documentation.  |
| Category  | Filter by the type of security issue or vulnerability that the rule detects.  | <ul><li>Dangerous method or function</li><li>SQL injection</li><li>Active debug code</li></ul> |
| Severities  | The higher the severity, the more critical the issues are that a rule detects.      |  <ul><li>High</li><li>Medium</li><li>Low</li></ul>      |
| Confidence  | Filter by the confidence of the rule to detect true positives.      |  <ul><li>High</li><li>Medium</li><li>Low</li></ul>      |
| Source  | Filter by the origin of a rule. | <ul><li><strong>Pro:</strong> Authored by Semgrep with cross-file (interfile) and cross-function (interprocedural) analysis capabilities, providing you with enhanced scan accuracy. For more information, see <a href="/semgrep-code/pro-rules/"><i class="fa-regular fa-file-lines"></i> Pro rules.</a></li><li><strong>Community:</strong> Authored by Semgrep, Inc or external contributors such as Trail of Bits.</li><li><strong>Custom:</strong> Rules created within your Semgrep organization. For more information, see <a href="/writing-rules/private-rules/"><i class="fa-regular fa-file-lines"></i> Private rules</a>.</li></ul>. |
| Ruleset  | Filter by the name of an existing ruleset. | <ul><li><a href="https://semgrep.dev/p/xss"><i class="fas fa-external-link fa-xs"></i> XSS ruleset</a></li><li><a href="https://semgrep.dev/p/react"><i class="fas fa-external-link fa-xs"></i> React ruleset</a></li></ul>       |
| Language| Filter by programming language | <ul><li>Python</li><li>JavaScipt</li><li>Ruby</li></ul>  |
| Minimum count of findings| Filter by the number of findings.  | <ul><li>10</li><li>100</li><li>500</li></ul>  |

:::tip
Use **Minimum count of findings** to quickly catch rules generating a lot of findings. This may be an indication of false positives or noise.
:::

## Rule entry reference

This section defines the columns of the rule entries in the Policies page:

| Filter | Description | Examples or possible values |
| -------  | ------ | ------ |
| Rule name  | Name of the rule that Semgrep Code uses for scanning.       | [<i class="fas fa-external-link fa-xs"></i> `docs-print-to-logger`](https://semgrep.dev/playground/s/KPzL)       |
| Labels  | Metadata describing the rule. This includes the rule's language, category (good security practices, coding standards), and more. |  <ul><li>Security</li><li>Code injection</li><li>PHP</li></ul>        |
| Open findings  | The number of open findings that the rule has detected across all scans.  |  n/a  |
| Fix rate  | The percentage of findings that are fixed through changes to the code.  | n/a   |
| Severity  | The higher the severity, the more critical the issues are that a rule detects.      |  <ul><li>High</li><li>Medium</li><li>Low</li></ul>      |
| Confidence  | Indicates confidence of the rule to detect true positives.      |  <ul><li>High</li><li>Medium</li><li>Low</li></ul> |
| Source  | Indicates the origin of a rule. | <ul><li><strong>Pro:</strong> Authored by Semgrep with cross-file (interfile) and cross-function (interprocedural) analysis capabilities, providing you with enhanced scan accuracy. For more information, see <a href="/semgrep-code/pro-rules/"><i class="fa-regular fa-file-lines"></i> Pro rules.</a></li><li><strong>Community:</strong> Authored by Semgrep, Inc or external contributors such as Trail of Bits.</li><li><strong>Custom:</strong> Rules created within your Semgrep organization. For more information, see <a href="/writing-rules/private-rules/"><i class="fa-regular fa-file-lines"></i> Private rules</a>.</li></ul>.      |
| Ruleset  | Rules are also organized in rulesets. Rulesets are groups of rules related through a programming language, OWASP category, or framework. | <ul><li><a href="https://semgrep.dev/p/xss"><i class="fas fa-external-link fa-xs"></i> XSS ruleset</a></li><li><a href="https://semgrep.dev/p/react"><i class="fas fa-external-link fa-xs"></i> React ruleset</a></li></ul> |
| Mode  | Specifies what workflow action Semgrep performs when a rule detects a finding. An additional filter, **Disabled**, is provided for rules that you have turned off and are no longer included for scanning. | See [Rule modes](#blocking-a-pr-or-mr-through-rule-modes) documentation. |

:::tip
To change assigned modes, select either the top **Matching Rules** checkbox to select all rules, or select individual checkboxes next to a rule, and then click **(<span className="placeholder">Number</span>) Edit** or click individual rules in the **Mode** column.
:::

## Multiple policies

:::info Multiple policies feature (private beta)
If you have the **multiple policies** feature, you can customize the rules that run on specific repositories. Currently, this beta is not accepting new participants.
:::

The multiple policies feature enables users to customize the rules that run on specific repositories.

Users create different policies that repositories can **subscribe** to.

This feature makes use of a **Global Policy** that runs on **all** repositories. Repositories cannot unsubscribe from it.

You can create a policy, for example, "Custom Coding Standards Policy", with some additional rules, and add it to one or more repositories. During a scan, these repositories run all of the rules from the **Global Policy** as well as all the rules from your "Custom Coding Standards Policy".

### Resolve workflow actions in multiple policies

If a rule is in multiple policies, then the rule is deduplicated and Semgrep prioritizes the workflow action based on the rule's mode where precedence is as follows:

1. Block
2. Comment
3. Monitor

For example, if an instance of `Rule A` is set to **Block**, the scan fails for PRs with any findings from that rule, even if the same `Rule A` is set to **Monitor** in another policy applied to that repository.
